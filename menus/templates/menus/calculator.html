{% extends './base.html' %}
{% load static %}
{% load humanize %}

{% block script %}
<script src={% static 'menus/js/counter.js' %}?ver=0.1111111111 defer></script>
<script src={% static 'menus/js/result.js' %}?ver=0.1111111 defer></script>
<script src={% static 'menus/js/append.js' %}?ver=0.1 defer></script>
{% endblock script %}

{% block content %}
<div class="wrap">
    <form class="form" id="form" method="post" action={% url 'calculator' %} onchange="this.submit();">
        {% csrf_token %}
        <div class="select">
            <select name="id">
                <option value="0">브랜드</option>
                {% for brand in brands %}
                    {% if id %}
                        {% if brand.id == id %}
                            <option value={{brand.id}} selected>{{brand.name}}</option>
                        {% else %}
                            <option value={{brand.id}}>{{brand.name}}</option>
                        {% endif %}
                    {% else %}
                        <option value={{brand.id}}>{{brand.name}}</option>
                    {% endif %}
                {% endfor %}
            </select>
        </div>

        <div class="item-list">
            <h3 class="title">기프티콘</h3>
            <div class="select">
                {% if id %}
                <select name="gifticon-ct">
                    <option value="" selected>카테고리</option>
                    {% with '음료 푸드 상품' as list %}
                        {% for category in list.split %}
                            {% if gifticon_ct %}
                                {% if category == gifticon_ct %}
                                    <option value={{category}} selected>{{category}}</option>
                                {% else %}
                                    <option value={{category}}>{{category}}</option>
                                {% endif %}
                            {% else %}
                                <option value={{category}}>{{category}}</option>
                            {% endif %}
                        {% endfor %}
                    {% endwith %}
                </select>
                {% else %}
                <select>
                    <option selected>카테고리</option>
                    <option disabled>브랜드를 먼저 선택해 주세요!</option>
                </select>
                {% endif %}

                {% if id and gifticon_ct %}
                <input type="text" name="gifticon-name" id="gifticon-name" onchange="form.submit();" value="{{gifticon_name}}">
                {% else %}
                <input type="text" name="gifticon-name" id="gifticon-name" disabled>
                {% endif %}
            </div>
            {% if id and gifticon_ct and gifticon_item %}
            <div class="item">
                <img class="image" src={% get_static_prefix %}{{gifticon_item.img_path}}>
                <div class="info">
                    <h3 class="name">{{gifticon_item.name}}</h3>
                    <h3 class="price" id="gifticon-price">{{gifticon_price|intcomma}}원</h3>
                    <div class="count">
                        <input type="button" onclick="counter('plus', 'gifticon-count');" value="+">
                        <input class="item-count" name="gifticon-count" id="gifticon-count" value={{gifticon_count}}>
                        <input type="button" onclick="counter('minus', 'gifticon-count');" value="-">
                    </div>
                </div>
            </div>
            {% endif %}
        </div>

        <div class="count-button">
            <input type="button" value="+ 제품 추가">
            <input type="button" value="- 제품 삭제">
        </div>

        <div class="item-list-container">
            <div class="item-list">
                <h3 class="title">제품 1</h3>
                <div class="select">
                    {% if id %}
                    <select name="menu1-ct">
                        <option value="" selected>카테고리</option>
                        {% with '음료 푸드 상품' as list %}
                            {% for category in list.split %}
                                {% if menu1_ct %}
                                    {% if category == menu1_ct %}
                                        <option value={{category}} selected>{{category}}</option>
                                    {% else %}
                                        <option value={{category}}>{{category}}</option>
                                    {% endif %}
                                {% else %}
                                    <option value={{category}}>{{category}}</option>
                                {% endif %}
                            {% endfor %}
                        {% endwith %}
                    </select>
                    {% else %}
                    <select>
                        <option selected>카테고리</option>
                        <option disabled>브랜드를 먼저 선택해 주세요!</option>
                    </select>
                    {% endif %}
    
                    {% if id and menu1_ct %}
                    <input type="text" name="menu1-name" id="menu1-name" value="{{menu1_name}}">
                    {% else %}
                    <input type="text" name="menu1-name" id="menu1-name" disabled>
                    {% endif %}
                </div>
                {% if id and menu1_ct and menu1_item %}
                <div class="item">
                    <img class="image" src={% get_static_prefix %}{{menu1_item.img_path}}>
                    <div class="info">
                        <h3 class="name">{{menu1_item.name}}</h3>
                        <h3 class="price" id="menu1-price">{{menu1_price|intcomma}}원</h3>
                        <div class="count">
                            <input type="button" onclick="counter('plus', 'menu1-count');" value="+">
                            <input class="item-count" name="menu1-count" id="menu1-count" value={{menu1_count}}>
                            <input type="button" onclick="counter('minus', 'menu1-count');" value="-">
                        </div>
                    </div>
                </div>
                {% endif %}
            </div>

            <div class="item-list">
                <h3 class="title">제품 2</h3>
                <div class="select">
                    {% if id %}
                    <select name="menu2-ct">
                        <option value="" selected>카테고리</option>
                        {% with '음료 푸드 상품' as list %}
                            {% for category in list.split %}
                                {% if menu2_ct %}
                                    {% if category == menu2_ct %}
                                        <option value={{category}} selected>{{category}}</option>
                                    {% else %}
                                        <option value={{category}}>{{category}}</option>
                                    {% endif %}
                                {% else %}
                                    <option value={{category}}>{{category}}</option>
                                {% endif %}
                            {% endfor %}
                        {% endwith %}
                    </select>
                    {% else %}
                    <select>
                        <option selected>카테고리</option>
                        <option disabled>브랜드를 먼저 선택해 주세요!</option>
                    </select>
                    {% endif %}
    
                    {% if id and menu2_ct %}
                    <input type="text" name="menu2-name" id="menu2-name" value="{{menu2_name}}">
                    {% else %}
                    <input type="text" name="menu2-name" id="menu2-name" disabled>
                    {% endif %}
                </div>
                {% if id and menu2_ct and menu2_item %}
                <div class="item">
                    <img class="image" src={% get_static_prefix %}{{menu2_item.img_path}}>
                    <div class="info">
                        <h3 class="name">{{menu2_item.name}}</h3>
                        <h3 class="price" id="menu2-price">{{menu2_price|intcomma}}원</h3>
                        <div class="count">
                            <input type="button" onclick="counter('plus', 'menu2-count');" value="+">
                            <input class="item-count" name="menu2-count" id="menu2-count" value={{menu2_count}}>
                            <input type="button" onclick="counter('minus', 'menu2-count');" value="-">
                        </div>
                    </div>
                </div>
                {% endif %}
            </div>
        </div>

        <div class="result">
            <h3>{{result|intcomma}}원</h3>
            <h3 id="result"></h3>
        </div>
    </form>

    <div class="option">
        <button><a href={% url 'menu-list' %}>추가할 수 있는 메뉴 보러가기</a></button>
        <button><a href={% url 'calculator' %}>초기화하기</a></button>
    </div>
</div>
{% endblock content %}